# Nome do Workflow que aparecerá na aba "Actions" do GitHub
name: Compilar APK Android

# Define quando o workflow deve ser executado
on:
  # Executa em cada push para o branch 'master'
  push:
    branches: [ "master" ]
  # Permite que você execute este workflow manualmente na aba Actions
  workflow_dispatch:

# Define os trabalhos (jobs) a serem executados
jobs:
  build:
    # O tipo de máquina virtual para executar o trabalho
    runs-on: ubuntu-latest

    steps:
      # 1. Baixa o código do seu repositório
      - name: Checkout do código
        uses: actions/checkout@v4

      # 2. Configura o JDK 11
      - name: Set up JDK 11
        uses: actions/setup-java@v4
        with:
          java-version: '11'
          distribution: 'temurin'
          cache: gradle

      # 3. Dá permissão de execução para o Gradle Wrapper
      - name: Dar permissão de execução ao gradlew
        run: chmod +x ./gradlew

      # 4. Compila o APK de depuração (debug)
      - name: Compilar com Gradle
        run: ./gradlew :appnes:assembleDebug

      # 5. NOVO PASSO: Lista os arquivos na pasta de saída para depuração
      # Isso nos mostrará exatamente onde o APK foi gerado.
      - name: Listar arquivos de saída
        run: ls -R appnes/build/outputs/

      # 6. CORRIGIDO: Faz o upload do APK usando um caminho mais flexível
      # O **/*.apk encontrará qualquer arquivo .apk dentro da pasta 'apk' e suas subpastas.
      - name: Upload do APK
        uses: actions/upload-artifact@v4
        with:
          name: NostalgiaLite-debug.apk
          path: appnes/build/outputs/apk/**/*.apk
